# CR_ledger

CR_ledger は、Clash Royale において  
**特定プレイヤー個人のバトルログを継続的に蓄積し、  
その人自身のオリジナルデッキを最適化・ブラッシュアップすること**  
に特化した分析アプリです。

**デモページ:** https://cr-ledger.pages.dev/  
ブラウザで動作・UIをすぐに確認できます。フィードバックは issue でお願いします。

---

## コンセプト

CR_ledger は、次のような思想に基づいて設計されています。

- 一般論・環境Tierよりも **個人の実戦データ** を最優先する
- サンプル数が少ない前提で、**断定せず検討材料を提示**する
- プレイングではなく **デッキ構成の改善** にフォーカスする
- テンプレデッキではなく **オリジナルデッキを極める** ことを支援する

「何を入れ替えるべきか」を決めるためではなく、  
**「何を考えるべきか」を明確にするためのツール**です。

---

## できること

CR_ledger では、特定プレイヤーの battlelog を蓄積し、以下のような分析を行います。

- 対戦相手カード・デッキのトレンド可視化  
- デッキ別の勝率・直近勝率の比較  
- 特定カードに対する条件付き勝率の算出  
- カード組み合わせ単位での苦手構成分析（共起分析）  
- デッキ改善フェーズを判断するための総評・弱点・改善候補の提示  

これらはすべて  
**「なぜ負けているのか」「どこに構造的な弱点があるのか」**  
を考えるための補助情報として提供されます。

---

## 既存アプリとの違い

CR_ledger は、Stats Royale / DeckShop Pro / deckai などの  
一般的な分析・デッキ紹介アプリとは目的が異なります。

- 特定プレイヤーの battlelog を **長期で蓄積**できる
- 一般的に強いデッキではなく **個人最適** を重視
- テンプレ紹介ではなく **オリジナルデッキ前提**
- プレイング分析ではなく **デッキ構成改善に特化**
- 統計的断定ではなく **意思決定支援** を目的とする

---

## リポジトリ構成

このリポジトリには、バックエンドとフロントエンドの両方が含まれています。

```
/
├─ worker-cr-ledger/  # API / analysis logic
├─ cr-ledger-pwa/     # Web UI
└─ docs/              # Design and specification documents
```

---

## 技術スタック（概要）

- Frontend: （例）React
- Backend: Cloudflare Workers
- Database: Cloudflare D1（SQLite）

※ 本リポジトリには **DBスキーマや実データは含まれていません**。

---

## データについて

CR_ledger は Clash Royale 公式 API の battlelog を唯一のデータソースとしています。

- カード配置・タイミング・操作ログは扱いません
- 分析はすべて battlelog 由来の情報に基づきます
- DB が必須であり、DB が存在しない状態ではアプリは動作しません

## DBドキュメント

DB 設計の詳細は以下にまとめています（Cloudflare D1 / SQLite）。

- [docs/db/schema.md](docs/db/schema.md)  
  テーブル定義・カラムの意味・制約・インデックスの解説（このファイルが主）。  
  ※ PRAGMA の出力結果（table_info / foreign_key_list / index_list）はこの末尾に追記します。

- [docs/db/schema.er.md](docs/db/schema.er.md)  
  Mermaid による ER 図（全体把握用）。

- [docs/db/notes.md](docs/db/notes.md)  
  設計思想・割り切り・「あえてやらないこと」のメモ。

---

## セットアップ（概要）

このアプリを動作させるには、以下が必要です。

- Cloudflare Workers 実行環境
- Cloudflare D1 データベース
- Clash Royale API のアクセストークン

具体的なセットアップ手順は `docs/` に記載予定です。

---

## 対象ユーザ

CR_ledger は、次のようなプレイヤーを想定しています。

- テンプレデッキより自分のデッキを使いたい人
- 一つのデッキを極めたい人
- 勝敗の原因を感覚ではなくデータで振り返りたい人
- デッキ構成の改善にじっくり取り組みたい人
- 一般論より「自分にとってどうか」を重視したい人

---

## ライセンス

TBD
